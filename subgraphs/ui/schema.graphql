type BigBangMarket @entity(immutable: true) {
  id: Bytes!
  chainId: Int! # uint32
  address: String! # address
  borrowToken: Token!
  collateralToken: Token!
  oracleAddress: String! # address
}

type SingularityMarket @entity(immutable: true) {
  id: Bytes!
  chainId: Int! # uint32
  address: String! # address
  borrowToken: Token!
  collateralToken: Token!
  oracleAddress: String! # address
}

type Token @entity(immutable: true) {
  id: Bytes!
  chainId: Int! # uint32
  address: String!
  name: String!
  symbol: String!
  decimals: Int! # uint32
}

type RemoteTOFTMeta @entity(immutable: false) {
  id: Bytes!
  lzChainId: Int! # uint16
  chainId: Int! # uint16
  address: String! # bytes
}

type TOFToken @entity(immutable: false) {
  id: Bytes!
  token: Token!
  underlyingToken: Token 
  remoteTOFTs: [RemoteTOFTMeta!]!
  markets: [SingularityMarket!]
  bigBangMarkets: [BigBangMarket!]
}

#START ######### TOB BASE ##########
type TapiocaOptionBrokerPaymentToken @entity(immutable: false) {
  id: Bytes!
  token: Token!
  oracleAddress: String! # address
  oracleData: Bytes!
}

type TapiocaOptionBrokerEpoch @entity(immutable: true) {
  id: String!
  epochId: BigInt! # uint256
  epochTAPAmount: BigInt! # uint256
  epochTAPValuation: BigInt! # uint256
}

type TapiocaOptionBroker @entity(immutable: false) {
  id: Bytes!
  paymentTokens: [TapiocaOptionBrokerPaymentToken!]!
  epochDuration: Int! # uint32
  tap: Token!
  currentEpoch: TapiocaOptionBrokerEpoch!
}
#END ########### TOB BASE ##########

#START ######### TOLP BASE ##########
type TOLPLockPosition @entity(immutable: false) {
  id: Bytes!
  sglAssetId: BigInt! # uint128
  ybShares: BigInt! # uint128
  lockTime: Int! # uint128
  lockDuration: Int! # uint128
  tolp: TOLP!
}

type TOLP @entity(immutable: false) {
  id: Bytes!
  nftId: BigInt! # uint256
  owner: String! # address - mutable

  lockPosition: TOLPLockPosition
}
#END ########### TOLP BASE ##########

#START ######### TOLP BASE ##########
type OTAPParticipatePosition @entity(immutable: false) {
  id: Bytes!
  participatedAtEpoch: TapiocaOptionBrokerEpoch!
  discount: Int! # uint256
  tolp: TOLP!
  otap: OTAP!
}

type OTAP @entity(immutable: false) {
  id: Bytes!
  nftId: BigInt! # uint256
  owner: String! # address

  participatePosition: OTAPParticipatePosition
}
#END ########### TOLP BASE ##########